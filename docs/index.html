<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hephaestus Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        html
        {
            scroll-behavior: smooth;
            animation:       main-fade 1s ease-out forwards;
        }

        *
        {
            margin:              10px;
            padding:             0;
            box-sizing:          border-box;
            font-optical-sizing: auto;
        }

        body
        {
            position:       relative;
            min-height:     100dvh;
            display:        flex;
            flex-direction: column;
        }

        header
        {
            padding:    2rem 0;
            text-align: center;
        }

        .container-fluid
        {
            padding: 0 2rem;
        }

        #nav-menu
        {
            position:      sticky;
            top:           0;
            background:    var(--pico-background-color);
            z-index:       1000;
            border-bottom: 1px solid var(--pico-muted-border-color);
            margin:        0;
            padding:       0.5rem 1rem;
        }

        #nav-menu ul
        {
            justify-content: center;
        }

        @keyframes main-fade
        {
            0%
            {
                opacity: 0;
                filter:  blur(10px) brightness(0.8);
            }
            100%
            {
                opacity: 1;
                filter:  blur(0) brightness(1);
            }
        }

        main
        {
            margin-top: 2rem;
        }
    </style>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body>

<header class="container">
    <h1>Hephaestus Documentation</h1>
    <p>Minimal JavaScript DOM builder and template engine</p>
</header>

<nav id="nav-menu">
    <ul class="container">
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#creating-elements">Creating Elements</a></li>
        <li><a href="#into">.into()</a></li>
        <li><a href="#templates">Templates</a></li>
        <li><a href="#reactivity">Reactivity</a></li>
        <li><a href="#stores">Stores</a></li>
        <li><a href="#di">Dependency Injection</a></li>
        <li><a href="#dev-mode">Dev Mode</a></li>
        <li><a href="#strict-alias">Strict Alias</a></li>
        <li><a href="#errors">Errors</a></li>
    </ul>
</nav>

<main class="container">

    <h2 id="introduction">Introduction</h2>
    <p>
        Hephaestus is a lightweight JavaScript library that makes DOM creation and templating concise, expressive,
        and safe. It provides a fully programmatic API for building DOM nodes and defining reusable component
        templates without dependencies or frameworks.
    </p>

    <ul>
        <li>Builder functions for all major HTML tags — now namespaced under <code>hepha.*</code>.</li>
        <li>A robust template engine with deep-merging override logic.</li>
        <li>Reactive state system for automatic DOM updates.</li>
        <li>Global aliasing system for cross-file element access.</li>
        <li>Optional dev-mode and strict aliasing for safer development.</li>
        <li>Singleton behavior — every file importing Hepha shares the same instance.</li>
    </ul>

    <div class="note">
        <strong>Important:</strong> Hephaestus is a singleton module.
        Importing it in multiple files returns the same instance.
        This means all <b>aliases</b>, <b>templates</b>, and <b>tag builders</b> are shared globally across your
        project.
    </div>

    <hr>

    <h2 id="getting-started">Getting Started</h2>

    <h3>Installation</h3>
    <pre><code>npm install hephaestus_js</code></pre>

    <h3>Importing</h3>
    <p>If you are using a bundler like Vite:</p>
    <pre><code>import hepha from "hephaestus_js";</code></pre>

    <p>Or via a relative path if not using a bundler:</p>
    <pre><code>import hepha from "./hephaestus.js";</code></pre>

    <p>
        Once imported, all tag builders are available as:
    </p>
    <pre><code>hepha.div(), hepha.span(), hepha.button(), hepha.h1(), ...</code></pre>

    <h3>Supported HTML Tags</h3>
    <p>These builders are available through <code>hepha.&lt;tag&gt;</code>:</p>

    <pre>
<code>div, span, p, button, h1-h6, ul, ol, li,
section, article, header, footer, main,
input, textarea, label, form, a, img,
nav, aside, figure, figcaption,
table, thead, tbody, tr, th, td,
video, audio, source, canvas, svg,
select, option, optgroup, fieldset, legend
</code></pre>

    <hr>

    <h2 id="creating-elements">Creating Elements</h2>
    <p>Each element is constructed with an <code>options</code> object:</p>

    <pre><code>const btn = hepha.button({
    text: "Click me",
    class: "btn primary",
    alias: "main_btn",
    events: {
        click: () => console.log("Clicked!")
    },
    style: {
        background_color: "red",
        padding: "10px"
    }
}).into("body");
</code></pre>

    <h3>Options Table</h3>
    <p>All other keys in options are treated as attributes of the element</p>

    <table>
        <tr>
            <th>Option</th>
            <th>Type</th>
            <th>Description</th>
            <th>Notes</th>
        </tr>

        <tr>
            <td>text</td>
            <td>string</td>
            <td>Sets <code>textContent</code></td>
            <td></td>
        </tr>
        <tr>
            <td>html</td>
            <td>string</td>
            <td>Sets <code>innerHTML</code></td>
            <td></td>
        </tr>

        <tr>
            <td>children</td>
            <td>array</td>
            <td>Array of child nodes</td>
            <td>Can include Hepha elements or native DOM nodes</td>
        </tr>

        <tr>
            <td>class</td>
            <td>string</td>
            <td>Space-separated class names</td>
            <td></td>
        </tr>

        <tr>
            <td>style</td>
            <td>object</td>
            <td>CSS style as snake_case (auto-converted to kebab-case)</td>
            <td><code>{ background_color: "red" }</code> → <code>background-color</code></td>
        </tr>

        <tr>
            <td>events</td>
            <td>object</td>
            <td>Event listeners (e.g. <code>{ click: fn }</code>)</td>
            <td>Automatically added with <code>addEventListener</code></td>
        </tr>

        <tr>
            <td>alias</td>
            <td>string</td>
            <td>Registers the element globally</td>
            <td>Accessible via <code>hepha.aliases.&lt;name&gt;</code></td>
        </tr>
    </table>

    <h3>Aliases Example</h3>

    <pre><code>
const title = hepha.h1({
    text: "Welcome!",
    alias: "site_title"
}).into("body");

hepha.aliases.site_title.textContent = "Updated!";
</code></pre>

    <hr>

    <h2 id="into">Appending Elements with <code>.into()</code></h2>

    <pre><code>
const card = hepha.div({ class: "card" }).into("#app");
</code></pre>

    <p>
        <b>.into()</b> accepts either:
    </p>
    <ul>
        <li>a CSS selector</li>
        <li>a DOM element</li>
    </ul>

    <p>
        If the selector does not match a node, Hepha throws error <code>202</code>.
    </p>

    <hr>

    <h2 id="templates">Templates</h2>
    <p>Templates define reusable components with deep-merging behavior.</p>

    <h3>Creating a Template</h3>

    <pre><code>
hepha.forge_template("card", "div", {
    class: "card",
    style: { padding: "20px" },
    children: [
        hepha.h2({ text: "Title" }),
        hepha.p({ text: "This is a card." })
    ]
});
</code></pre>

    <h3>Using a Template</h3>

    <pre><code>
const box = hepha.use_template("card", {
    style: { background_color: "black" },
    children: [
        hepha.p({ text: "Extra content!" })
    ]
}).into("body");
</code></pre>

    <h3>How templates treat overrides</h3>

    <pre><code>
base     = { style: { color: "red", padding: "10px" } }
override = { style: { padding: "20px" } }

→ result = { style: { color: "red", padding: "20px" } }
</code></pre>

    <div class="note">
        <strong>Note:</strong> Templates and aliases are global across all imports,
        because Hepha is a shared singleton instance.
    </div>

    <hr>

    <h2 id="reactivity">Reactivity</h2>
    <p>
        Hephaestus provides a simple reactivity system inspired by Vue. You can create reactive state and
        link it to element properties like <code>text</code>.
    </p>

    <h3>1. Initialize State</h3>
    <p>
        Use <code>hepha.init_state(name, initialState)</code> to create a named reactive state object.
        The state is automatically registered in <code>hepha.states[name]</code>.
    </p>
    <pre><code>const state = hepha.init_state('main', { count: 0 });
// Also accessible via hepha.states.main</code></pre>

    <h3>2. Create a Reactive Reference</h3>
    <p>
        Use <code>hepha.ref()</code> to wrap a getter function that accesses your reactive state.
        When passed to a Hepha element, the element will automatically update whenever the state changes.
    </p>

    <pre><code>
// Snapshot: value won't update when state.count changes
hepha.h1({ text: state.count }).into("body");

// Reactive: h1 will automatically update when state.count changes
hepha.h1({ text: hepha.ref(() => state.count) }).into("body");

// Triggering an update:
state.count++; 
</code></pre>

    <hr>

    <h2 id="stores">Global Stores</h2>
    <p>
        Stores are centralized reactive objects that can optionally persist their state to <code>localStorage</code>.
    </p>
    <pre><code>// Create a persistent store
hepha.store('user_prefs', { theme: 'light' }, { persist: true });

// Access it anywhere via hepha.stores
const prefs = hepha.stores.user_prefs;

hepha.div({
    text: hepha.ref(() => `Theme is ${prefs.theme}`)
}).into('body');
</code></pre>

    <hr>

    <h2 id="di">Dependency Injection</h2>
    <p>
        Share services or configuration across your application without prop drilling using <code>provide</code> and <code>inject</code>.
    </p>
    <pre><code>// In your entry point
hepha.provide('API_URL', 'https://api.example.com');

// In any component
const apiUrl = hepha.inject('API_URL');
</code></pre>

    <hr>

    <h2 id="dev-mode">Dev Mode</h2>
    <pre><code>hepha.use_dev();</code></pre>

    <p>Logs template creation, template usage, element creation, and alias overwrites.</p>

    <hr>

    <h2 id="strict-alias">Strict Alias Mode</h2>
    <pre><code>hepha.use_strict_alias();</code></pre>

    <p>Prevents alias overwriting (error <code>301</code>).</p>

    <hr>

    <h2 id="errors">Error Codes</h2>

    <table>
        <tr>
            <th>Code</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>101</td>
            <td>Component isn't a valid Hepha element</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Template does not exist</td>
        </tr>
        <tr>
            <td>201</td>
            <td>Element is no longer in the DOM</td>
        </tr>
        <tr>
            <td>202</td>
            <td>Parent element not found</td>
        </tr>
        <tr>
            <td>301</td>
            <td>Alias overwrite blocked in strict mode</td>
        </tr>
    </table>

    <hr>

    <h2>Best Practices</h2>
    <ul>
        <li>Use aliases only for elements that must be accessed globally.</li>
        <li>Use templates for repetitive UI patterns.</li>
        <li>Use <code>hepha.init_state()</code> and <code>hepha.ref()</code> for dynamic UI updates.</li>
        <li>Use <code>hepha.store()</code> for global and persistent state.</li>
        <li>Enable <code>dev_mode</code> while developing.</li>
        <li>Remember: all files share the same Hepha instance.</li>
        <li>Use snake_case for styles as Hepha converts it automatically.</li>
    </ul>

</main>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</html>
